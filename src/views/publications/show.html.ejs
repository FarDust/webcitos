<div class="products">
  <div class="pcard_show">
    <a class="box_show_1" href="<%= userPath(user) %>" style="text-decoration:none;">
      <h1><%= publication.title %></h1>
      <h2>State: <%= publication.state %></h2>
      <%= publication.description %> <br>
      <h4> Uploaded by <%=user.name%></h4>
      <img class="imgcard_publi_user rounded" src="<%= getUserImagePath(user) %>" alt="avatar"/>
      <h4>Information</h4>
      Phone: <%=user.phone%> <br>
      E-mail: <%=user.email%> <br> <br>
      <% if (publication.userID === currentUser.id) { %>
        <button class="button-publi" onclick="window.location.href='<%= editPublicationPath(publication) %>'">Edit publication</button>
      <% } else if (publication.state == 'gift' || publication.state == 'exchange'){ %>
        <form class="form-button-publi" action="<%=createRequestPath(publication)%>">
          <input type="submit" value="Create a new offer" />
        </form>
      <% } %>
    </a>
    <div class="box_show_2">
      <img class="imgcard_publi" src="<%= getItemImagePath(item) %>" alt="Photo of the item"/>
      <h2><%= item.model %></h2>
      <p id="features">
        Brand: <%= item.brand %> <br>
        Screen size: <%= item.screenSize %> inches <br>
        Current state: <%= item.state %> <br>
        Aditional: <%= item.aditional %><br>
        Category: <%= item.category %> <br>
      </p>
      <% if (publication.userID === currentUser.id) { %>
        <button class="button-publi" onclick="window.location.href='<%= editItemPath(item) %>'">Edit item</button>
      <% } %>
    </div>
  </div>
  <% if(requests.length > 0 && publication.userID === currentUser.id) {%>
  <h2>Offers received</h2>
  <div class="content">
    <div class="row card-group slider">
      <% requests.forEach((request) => { %>
      <% if (publi_requests[request.id]) {%>
      <div class="col-6">
        <div class="card">
            <a href="<%= userPath(users_requests[request.id]) %>">
              <h4 class="card-header">Offer from <%= users_requests[request.id].name %></h4>
            </a>
            <a href="<%= getPubliShowPath(publi_requests[request.id]) %>">
              <div class="card-content">
                <%= request.message %> <br> <br>
                Item offered: <%= items_requests[request.id].model %>
              </div>
            </a>
            <% if (publication.state != 'pendent' && publication.state != 'inventory') {%>
            <div class="card-footer">
              <ul>
                <li>
                  <form class="form-button-publi" action="<%= postNewTradePath(request) %>" method="get">
                    <input type="hidden" name="id_request" value="<%=request.id%>" />
                    <input type="hidden" name="state" value="pendent" />
                    <li><button class="button-publi" type="submit" formmethod="post">Accept offer</button></li>
                  </form>
                </li>
                <li>
                  <form class="form-button-publi" action="<%= getDestroyRequestPath(request) %>" method="post">
                    <input type="hidden" name="_method" value="delete" />
                    <button class="button-publi" type="submit">Delete offer</button>
                  </form>
                </li>
              </ul>
            </div>
            <% } %>
        </div>
      </div>
      <% } else {%>
      <div class="col-6">
        <div class="card">
            <a href="<%= userPath(users_requests[request.id]) %>">
              <h4 class="card-header">Petition from <%= users_requests[request.id].name %></h4>
            </a>
            <div class="card-content">
              <%= request.message %> <br> <br>
            </div>
            <% if (publication.state != 'pendent' && publication.state != 'inventory') {%>
            <div class="card-footer">
              <ul>
                <li>
                  <form class="form-button-publi" action="<%= postNewTradePath(request) %>" method="get">
                    <input type="hidden" name="id_request" value="<%=request.id%>" />
                    <input type="hidden" name="state" value="pendent" />
                    <li><button class="button-publi" type="submit" formmethod="post">Accept offer</button></li>
                  </form>
                </li>
                <li>
                  <form class="form-button-publi" action="<%= getDestroyRequestPath(request) %>" method="post">
                    <input type="hidden" name="_method" value="delete" />
                    <button class="button-publi" type="submit">Delete offer</button>
                  </form>
                </li>
              </ul>
            </div>
            <% } %>
        </div>
      </div>
      <% } %>
      <% }) %>
    </div>
  </div>
  <% } %>
  <% if (trade && trade.state == 'concreted') {%>
  <h2>Trade details</h2>
<div class="row">
  <div class="col-1"></div>
  <div class="col-10">
    <div class="content">
      <div class="row">
        <div class="col-5">
            <div id="emmiter-user" class="card">
              <div class="card-contex">
                <h3 class="card-header"><%= trade.emmiter.name %></h3>
                <div class="card-content">
                  Email: <%= trade.emmiter.email %> <br/>
                  Phone: <%= trade.emmiter.phone %>
                </div>
              </div>
            </div>
            <div id="emmiter-item" class="card">
              <div class="card-contex">
                <h4 class="card-header">Offer</h4>
                <div class="card-content">
                  Brand: <%= trade.emmiter.item.brand %> <br/>
                  Model: <%= trade.emmiter.item.model %> <br/>
                  Category: <%= trade.emmiter.item.category %> <br/>
                  Screen size: <%= trade.emmiter.item.screenSize %>'' <br/>
                  Description<br/>
                  <%= trade.emmiter.item.aditional %>
                </div>
              </div>
            </div>
        </div>
        <% if(trade.receptor.item !== null) { %>
        <div class="col-2">
          <img class="exchange_image" src="https://00e9e64bacbd6bbf13239e124317c3de6d09bb0e0bdec49ecb-apidata.googleusercontent.com/download/storage/v1/b/webcitos_images/o/exchange.png?qk=AD5uMEu-ohnaF-Nq1OS7PEUom9dwvDGBFQpbEJjK3xSikAWbFk3CNEgmRJWMcbGor_P1EmcqngZ4nEwCjlr5tacLJdsmDiF5rlVmj2bnSZrIw3rtx0OgIuhG5QkqZ9jdMRecWQd9ImGMSfwofy1lHgmNAs1qO0NWlWx_2sdymxdtsjpshcJqDfMpGuAsC2KkBQ164C98TpsBwFZGhA4aMqjHPT64-jvJ2t-k8TKPb2kJH2it384Y4mrHEot2GlJ31fuiT0bjRtVttXpvhvRjdlHaLYS1WkjxtPdwlVEK3ADDNU2fK9mWjZkQk3LAruVAPeTo7A58TdtWSsq1zb6KXhbW7kuniICcH2E_ZStr6Gm3MoenDsqgrTO2BdzeHFj_CCHdW5AWBTb3GBMmm1VcECG09tqYb-Onoahnn-uaoTfE3lRh1-RjqBrh-6AdMoM-2z-Sdx7xu4QP2qwl5O914cLTBnJbFk1zx4Cjd1r2XtkokXIWIJGI1evro75WKY5t3F_y1OndcGhQK_iorVe9BRekClHIz7PJUo86n_26UH24aX_p1G6m5btWWTMsR5A07hb4vmKNW9IZi-Y9xRWMprop8oAZrfZ2hm-4LnMmeAYEPL2jPM5GPsowTudsyNYtAxQ-EXm6CzA8RNF6Ni3SVMX_92mBUYVCv0haXhwZCpKHLP4zFaWJ60OS9N7xx0H-deN_JVFRM2nSFp2MY0d8sSMX1w2zcJ9nNvFcqiK8OHNOI9DPYTzS4YkJOsF4ENnm-ihk84nnMYTD" alt="trade"/>
        </div>
        <% } else { %>
        <div class="col-2">
          <img class="exchange_image" src="https://00e9e64bac99cf8526d1e8cb6b13b3df2ae787bdee2f3bb17a-apidata.googleusercontent.com/download/storage/v1/b/webcitos_images/o/logo.svg?qk=AD5uMEugl13wzBPNYnsqYeExU7Patdrl_ue7bpHpK7JYhSGgjDTILi-JGSTD2lhliNbaly9DIXWaZk5hnxmYKoTFkg4DdaW4CF2mXTsaX1v6KTGCcfdG-B5rB6AahcqIElbpwuqP3qPT05twn0oK4ObiW7wtGpIQrGi615T-eIIcIAc44L0HKIf5SNZIhuJOQ5zjGiRDTaBMYbHVliKWGl4jCDh1eYVdQXviIEW0Mbs9kX7Ul0dIp1Wx1VKTgf17sTyA5FGa2idzVzM18cfV08ZmgE8dMvejjaMR5dK4pYkscadvNexc5pobs9TpsJ52t95eZYqSHFHBFWPa9kNxwA_KwJUF_gJ35-JzOWjlYtx6Kkzc2LTo6rzchVK4uOuR28jP-iR1aFT556KdUWcTuYL3_-ikFUOI5r4zzF7sSyfnFVWk7nrwh10rLu3uB5SVp9anJivskWRN9ITODOjVeEFV6Aka5McrA5iDtbkpO7SgXQcYd8rvyew8QGWDgY6Krn4C_Nj8JIbI2ZRDSe1-OB5YyR2ekSZVE8_-hzIUnDR9xBkE-V6kLVxi92vnL3mVjVIijWJMNiC2vl5BAXbwIK4YAS2Lq-IvKS-lwqkxI-sPM_bUwgZdhP2V4DkIaUM3MD--IwYhdwAbFbGvyuROwCZofl9mk52if1Fw6a1XuMO-tlofjVHezbg49wkG5Cx7hB90Jdvxt5jD-JXzrZ8xGiVWI8xRevM0k0uB-kyqgoUYqyDjY8HqB6jkXyX8ybS2AUZQ1PWslg8S" alt="trade"/>
        </div>
        <% } %>
        <div class="col-5">
          <div id="receptor-user" class="card">
            <div class="card-contex">
              <h3 class="card-header"><%= trade.receptor.name %></h3>
              <div class="card-content">
                Email: <%= trade.receptor.email %> <br/>
                Phone: <%= trade.receptor.phone %>
              </div>
            </div>
          </div>
          <% if (trade.receptor.item !== null) { %>
          <div id="receptor-item" class="card">
            <div class="card-contex">
              <h4 class="card-header">Offer</h4>
              <div class="card-content">
                Brand: <%= trade.receptor.item.brand %> <br/>
                Model: <%= trade.receptor.item.model %> <br/>
                Category: <%= trade.receptor.item.category %> <br/>
                Screen size: <%= trade.receptor.item.screenSize %>'' <br/>
                Description<br/>
                <%= trade.receptor.item.aditional %>
              </div>
            </div>
          </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
  <div class="col-1"></div>
  <% if (trade.review !== null) { %>
  <div class="col-4"></div>
  <div class="col-4">
    <div class="card">
      <div class="card-contex">
        <h4 class="card-header">Review from <%= trade.receptor.name %></h4>
        <div class="card-content">
          Fullfillment offer: <%= trade.review.fullfillment_offer %> stars <br/>
          Quallity offered: <%= trade.review.quality_offered %> stars <br/>
          Puntuality: <%= trade.review.puntuality %> stars <br/>
          <% if (trade.review.content !== '') { %>
          <hr/>
          Extra commentaries: <br/>
          <%= trade.review.content %>
          <% } %>
        </div>
      </div>
    </div>
  </div>
  <% } %>
</div>
  <% } %>
</div>